{% extends 'base_2row_2col.html' %}

{% block css %}
<link href="/static/lightbox/css/lightbox.css" rel="stylesheet" />
{% endblock %}

{% block js %}
<script src="http://malsup.github.com/jquery.form.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="/static/lightbox/js/lightbox.js"></script>
<script src="/static/js/manager.js"></script>
<script src="/static/js/formatter.js"></script>
<script src="/static/js/date.manager.js"></script>
<script src="/static/js/palette.manager.js"></script>
<script src="/static/js/users.manager.js"></script>
<script src="/static/js/days.ui.js"></script>
<script src="/static/js/days.manager.js"></script>
<script src="/static/js/expenses.ui.js"></script>
<script src="/static/js/expenses.manager.js"></script>
<script src="/static/js/categories.ui.js"></script>
<script src="/static/js/categories.manager.js"></script>
{% endblock %}

{% block jsready %}
DateManager.onReady($('#current_month'));
PaletteManager.onReady();
UsersManager.onReady(Logger);
DaysUI.onReady(Formatter, PaletteManager, $('#days'));
DaysManager.onReady(Logger, DateManager, DaysUI);
ExpensesUI.onReady(
        Formatter, PaletteManager, $('#current_month_overall'),
        $('#expenses'));
ExpensesManager.onReady(Logger, DateManager, ExpensesUI);
CategoriesUI.onReady(Formatter, PaletteManager, $('#categories'));
CategoriesManager.onReady(Logger, DateManager, CategoriesUI);
Manager.onReady(Logger, 30000);

Manager.update(function() {
    DaysManager.onUpdate();
    ExpensesManager.onUpdate();
    CategoriesManager.onUpdate();
})
Manager.monthChange(function(year, month) {
    DateManager.onMonthChange(year, month);
    PaletteManager.onMonthChange(year, month);
    ExpensesManager.onMonthChange(year, month);
    CategoriesManager.onMonthChange(year, month);
});

ExpensesManager.addSubmit(function() {
    DaysManager.onUpdate();
    CategoriesManager.onUpdate();
})
ExpensesUI.addExpense(function($exp) {
    ExpensesManager.onAddExpense($exp);
})
Manager.onUpdate(0);
{% endblock %}

{% block pre_row1 %}
    {% include 'elements/logo_small.html' %}
    {% include 'greetings.html' %}
{% endblock %}

{% block row1_col1 %}
    <h3 class="title mid">Track New</h3>
    {% include 'expenses_add.html' %}
{% endblock %}

{% block pre_row2 %}
{% include 'expenses_more.html' %}
<h2 class="title mid"><span id="current_month"></span></h2>
<div class="title mid"><span id="current_month_overall"></span></div>
<br style="clear: both" />
{% endblock %}

{% block row1_col2 %}
    <h3 class="title mid">Last 30 days</h3>
    <div id="days"></div>
{% endblock %}

{% block row2_col1 %}
    <h3 class="title mid">By Date</h3>
    <div id="expenses"></div>
{% endblock %}

{% block row2_col2 %}
    <h3 class="title mid">By Category</h3>
    <div id="categories"></div>
{% endblock %}
